{% set (r, g, b) = review_entry.book.cover.tint_color | from_hex %}

<style>
  {% include "_review_style.css" %}
</style>

<div class="review_preview {% if review_entry.review.rating == 5 and not is_index %}review_fave{% endif %}"
id="review_preview_{{ review_entry.book.slug }}">
  <a href="/{{ review_entry.out_path() }}">
    <div class="book_thumbnail">
      {% set book = review_entry.book %}
      {% include "_book_cover.html" %}
    </div>

    <div class="book_metadata">
      <p class="title">
        {{ review_entry.book.title | smartypants | safe }}
        {% if review_entry.book.series %}
        <span class="book-series">({{ review_entry.book.series | smartypants | safe }})</span>
        {% endif %}
      </p>
      <p>
        <small>
          {% if review_entry.book.author %}
            by {{ review_entry.book.author }}
            {%- if review_entry.book.editor -%}
            ,
            {% endif %}
          {% endif %}

          {% if review_entry.book.editor %}
          edited by {{ review_entry.book.editor }}
          {% endif %}

          {% if review_entry.book.retold_by %}
          retold by {{ review_entry.book.retold_by }}
          {% endif %}

          {%- if review_entry.book.publication_year %}
            ({{ review_entry.book.publication_year}})
          {%- endif -%}
            <br/>
          {% if review_entry.review.date_read %}
          read {{ review_entry.review.date_read | render_date }}
            <br/>
          {% endif %}

          {% if review_entry.review.rating and not review_entry.review.did_not_finish %}
            <span class="star_rating">

            {% for _ in range(review_entry.review.rating) -%}
            ★
            {%- endfor -%}
            {%- for _ in range(5 - review_entry.review.rating) -%}
            ☆
            {%- endfor %}
            </span>
          {% endif %}

          {% if review_entry.review.did_not_finish %}
          (did not finish)
          {% endif %}
        </small>
      </p>
    </div>
  </a>
</div>
