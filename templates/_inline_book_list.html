{% for book_entry in all_books %}
{% set (r, g, b) = book_entry.book.cover.tint_color | from_hex %}

<style>
  #reading_{{ r }}_{{ g }}_{{ b }} {
    background: rgb(
      {{ (r * 0.08 + 0.92 * 255) | int }},
      {{ (g * 0.08 + 0.92 * 255) | int }},
      {{ (b * 0.08 + 0.92 * 255) | int }}
    );
    border-color: {{ book_entry.book.cover.tint_color }};
  }

  #reading_{{ r }}_{{ g }}_{{ b }} a {
    color: {{ book_entry.book.cover.tint_color }};
  }

  #reading_{{ r }}_{{ g }}_{{ b }} a:hover {
    background: rgb(
      {{ (r * 0.35 + 0.65 * 255) | int }},
      {{ (g * 0.35 + 0.65 * 255) | int }},
      {{ (b * 0.35 + 0.65 * 255) | int }}
    );
  }
</style>

<div class="reading" id="reading_{{ r }}_{{ g }}_{{ b }}">
  <div class="reading_inner">
    <div class="book_thumbnail">
      {% set book = book_entry.book %}
      {% include "_book_cover.html" %}
    </div>

    <div class="book_metadata">
      <p class="title">{{ book_entry.book.title | smartypants | safe }}</p>
      <p>
        <small>
          by {{ book_entry.book.author }}
          {%- if book_entry.book.publication_year %}
            ({{ book_entry.book.publication_year}})
          {%- endif -%}
        </small>
      </p>
    </div>
  </div>
  {% if book_entry.plan.text %}
  <div class="note">
    {{ book_entry.plan.text | render_markdown | safe }}
  </div>
  {% endif %}
</div>
{% endfor %}
